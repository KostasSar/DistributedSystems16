# DistributedSystems16
University group project conserning both the internal and external systems of a hypothetical company that recycles cars and rewards the owners.

ΑΛΛΑΓΕΣ:


ΣΤΗ ΒΑΣΗ:

ΠΙΝΑΚΑΣ CUSTOMER:
Πεδία: Εntry Number/Όνομα/Επίθετο/ΑΦΜ/Ημερομηνία Εγγραφής/Κατάστημα Εγγραφής

1.Η ημερομηνία εγγραφής θα μας χρειαστεί στο επόμενο στάδιο, οπού στο εξωτερικό σύστημα η ημερ/νια εγγραφής του πελάτη και η παραλαβή του αυτοκίνητου πρέπει να έχουν το πολύ διαφορά 3 μέρες.
2.Το "κατάστημα εγγραφής" το χρειαζόμαστε σαν αναγνωριστικό.
3.Εφυγε το πεδίο "επιστροφής χρήματων".
4.To πεδίο Εntry και εδώ και στον πίνακα αυτοκίνητων δεν είναι πια autoincrement γιατί δεν αυξανόταν σωστά, επομένως σε κάθε update της
βάση πρώτα γίνεται ένα select που φέρνει τον πιο πρόσφατο entry Number.

ΠΙΝΑΚΑΣ VEHICLE 

Πεδία : Entry Number/Μοντέλο/Πινακίδες/Τύπος καυσίμου/ Ημ/νια κατασκευής/Κατάσταση/ΑΦΜ ιδιοκτήτη
/κατάστημα εγγραφής/κατάσταση αίτησης (unchecked ή confirmed)/Ποσό επιστροφής/Ημερομηνίες εγγραφής – ελέγχου - παράδοσης χρημάτων

Ο μηχανικός ελέγχει την κατάσταση του αυτοκίνητου και παραδίδει τα χρήματα

ΣΤΟ ΠΡΟΓΡΑΜΜΑ:
 
Login servlet :
Αλλαγές:
1.Πρωτα γίνεται  έλεγχος αν ο χρήστης είναι ο διαχειριστής, φτιάχνεται μόνο ένα cookie με το userName και γίνεται ανακατεύθυνση 
χωρίς να γίνει σύνδεση με την βάση.
2.Ελεγχεται αν τα πεδία του id και κωδικού είναι κενά πριν ανοίξει η σύνδεση έτσι ώστε να μην πετάξει η βάση nullpointerexception 
και μπλοκάρει το πρόγραμμα.

AN O ΧΡΗΣΤΗΣ ΕΙΝΑΙ Ο ΔΙΑΧΕΙΡΙΣΤΗΣ:

Ανακατευθύνεται στην σελίδα AdminActions.html η οποία δεν έχει αλλάξει 

ADMINSERVLET:

Αλλαγές: 

1.Για κάθε try/catch στην σύνδεση με την βάση υπάρχει ένα αντίστοιχο μήνυμα επιτυχίας/λάθους που εκτυπώνεται
στον χρήστη και ανακατεύθυνση στην html σελίδα
2.Και εδώ πριν ξεκινήσει η σύνδεση με την βάση έχει μπει έλεγχος αν κάποιο πεδίο είναι κενό και πετάει το αντίστοιχο μήνυμα
3.Για το Modify πλέον ο διαχειριστής μπορεί να αλλάξει οποιοδήποτε πεδίο θέλει, με οποιαδήποτε σειρά και
όσα πεδία θέλει ακόμα και να βάλει καινούριο id χρησιμοποιώντας το αρχικό id του υπάλληλου/μηχανικού.
Αν θέλει να αλλάξει το id αυτόματα το πρόγραμμα ενημερώνει τα πεδία κατάστημα, θέση και δικαιώματα χρήστη στον πίνακα users
χωρίς να κάνει κάτι ο διαχειριστής.
4.Μικρο αλλαγές στον κώδικα για να συμφωνούν με τις αλλαγές στην βάση.


Βελτιώσεις/Προτάσεις:
1.Ελεγχος στην βάση αν υπάρχουν κενές θέσεις για δημιουργία νέου υπάλληλου/μηχανικού
εφόσον κάθε κατάστημα έχει 1 μηχανικό και 3 υπάλληλους αν πχ όλα τα καταστήματα είναι γεμάτα απο υπάλληλους να πετάει μήνυμα λάθους αν ο 
διαχειριστής πάει να δημιουργήσει νέο χρήστη.
2.Ελεχγος σωστού pattern για το user id  (κατάστημα – θέση - κωδικός) σε περίπτωση π κάνει λάθος ο διαχειριστής κατά την
πληκτρολόγηση. Έχω σκεφτεί δυο τρόπους: α) με regex αλλά κοστίζουν σαν μέθοδος και δεν τις προτιμάνε πολλοί απο ότι διάβασα
β) με τον κλασικό charAt και substring για σύγκριση, θα μπουν απλά περισσότερες if.
3.Μόλις βάλει ο διαχειριστής στην φόρμα δημιουργίας νέου πελάτη , το user id να συμπληρώνονται τα πεδία θέση/κατάστημα/δικαιώματα χρήστη της φόρμας αυτόματα.
4.Στο κομμάτι του κώδικα που διαχειρίζεται την αλλαγή στοιχείων των υπάλληλων, όταν ενημερώνεται κάθε πεδίο της βάσης, ξαναφορτώνει την ιδιά σελίδα 
και εκτυπώνει μήνυμα επιτυχίας, αν για παράδειγμα  αλλάξει το όνομα  το επίθετο και τον κωδικό θα φορτώσει τρεις φορές την σελίδα, θα εκτυπώσει και τα τρία μηνύματα
επιτυχίας στην ιδιά σελίδα, και εν τελεί θα δείξει τα ιδιά κουμπιά τρεις φορές (δοκιμάστε το για να καταλάβετε τι εννοώ :P).Αν μπορούμε να βάλουμε κάποιο δείκτη (?) σε κάθε if
ώστε να το αποφύγουμε αυτό; και ανάλογα με την τιμή του δείκτη να ανανεώσει μια φορά στο τέλος την σελίδα και να βγάλει το μήνυμα επιτυχίας;
5.Οτι παραπάνω  ελέγχους μπορείτε να σκεφτείτε για τα πεδία εισαγωγής.
 

ΑΝ Ο ΧΡΗΣΤΗΣ ΕΙΝΑΙ ΥΠΑΛΛΗΛΟΣ:

Ανακατευθύνεται μετά το Login servlet CustomerRegisterServlet και CustomerRegistration.html

CUSTOMER REGISTER SERVLET και CUSTOMEREGISTRATION.HTML

Αλλαγές:

1.Κλασικα έλεγχος αν τα πεδία εισαγωγής είναι κενά για να μην γκρινιάζει η βάση.
2.Επειδη το όνομα και το επίθετο δεν μας πολύ ενδιαφέρουν απο την άποψη ότι είναι string τύπου και ότι και να γράψει ο
υπάλληλος η βάση θα το δεχθεί, έβαλα έλεγχο στο αφμ που πρέπει να είναι αναγκαστικά 9 ψηφιά
Πρώτα ελέγχεται αν το stringlength είναι όντως 9, αν όχι σταματάει η διεργασία και πετάγεται μήνυμα λάθους.
3.Στην συνέχεια το ΑΦΜ μετατρέπεται απο String σε Long με την parseLong η οποία αν το string περιέχει γράμματα πετάει exception για αυτό
έχει μπει μέσα σε try/catch , και στο catch εμφανίζεται μήνυμα λάθους στον χρήστη ότι έχει βάλει λάθος το ΑΦΜ και ότι πρέπει να περιέχει μόνο αριθμούς.
3.Επειτα ελέγχει αν τα στοιχεία του χρήστη υπάρχουν ήδη στην βάση (αποφεύγουμε έτσι να γκρινιάζει η βάση ότι βάλαμε ξανά ίδιο primary key).
Αν υπάρχουν ήδη, ανακατευθύνεται ο υπάλληλος στην φόρμα αυτοκίνητου, αν όχι δημιουργείται κανονικά νέος χρήστης στην βάση
4.Το πεδίο του πίνακα customers που έχει την ημερομηνία εγγραφής συμπληρώνεται αυτόματα χωρίς να κάνει κάτι ο υπάλληλος.
5.Μπηκαν όλοι οι πιθανοί έλεγχοι για την βάση, επομένως αν αποτύχει η ενημέρωση της βάσης θα πετάει ένα μήνυμα στην catch που λέει ότι μάλλον φταίει η σύνδεση
γιατί κολλάει που και που.
6.Οτι παραπάνω  ελέγχους μπορείτε να σκεφτείτε για τα πεδία εισαγωγής.

Σημείωση:
1.Για το CUSTOMERREGISTRATION.HTML Το κουμπι που υπήρχε "View Customer Prize" δεν χρειάζεται πια γιατί το ποσό επιστροφής το δίνει ο μηχανικός
Άλλαξα το κουμπι σε "View Customer Information" ώστε οι υπάλληλοι να μπορούν να δουν το πελατολόγιο μήπως μας χρειαστεί για το εξωτερικό σύστημα.
Η αναζήτηση γίνεται κλασικά με βάση αφμ.



CARFORM SERVLET ΚΑΙ HTML

1.Κλασικα έλεγχος αν τα πεδία εισαγωγής είναι κενά για να μην γκρινιάζει η βάση.
2.Ελεγχος για τον αν ο αριθμός κυκλοφορίας έχει length 8 , αν πετάει μήνυμα λάθους και διευκρινίζει ότι πρέπει να είναι της μορφής ABC-1234.
3.Αν η προσθήκη του αυτοκίνητου είναι επιτυχής ο υπάλληλος ανακατευθύνεται στο EmployeeLogout και διαλέγει αν θέλει να κάνει εγγραφή νέου πελάτη/προβολή πελάτη ή Logout.


Βελτιώσεις/Προτάσεις:
1.Αν γίνεται στην carform.html να μπουν τα κουμπιά για την έξοδο ή νέα εγγραφή πελάτη, αλλιώς το αφήνουμε όπως έχει με το EmployeeLogout.hmtl.
2.Ελεγχος για το pattern του αριθμούς κυκλοφορίας "3γραμματα-4αριθμοι".
3.Οτι παραπάνω  ελέγχους μπορείτε να σκεφτείτε για τα πεδία εισαγωγής.


ΑΝ Ο ΧΡΗΣΤΗΣ ΕΙΝΑΙ ΜΗΧΑΝΙΚΟΣ:

MechanicServlet και MechanicActions.html

Αλλαγές:

1.Καταρχην οι σελίδες πήραν αγγλικά ονόματα :P
2.Στην html προστέθηκε πεδίο Logout.
3.Κλασικα έλεγχος αν τα πεδία εισαγωγής είναι κενά για να μην γκρινιάζει η βάση.
4.Λυθηκε το θέμα με τον υπολογισμό ποσού επιστροφής, μπήκε τύπου float.
5.Αλλαξε ο κώδικας για τι αλλάξαν και τα πεδία της βάσης , οι ημερομηνίες/κατάσταση αίτησης κλπ. γεμίζουν αυτόματα.
6.Για κάθε try/catch στην σύνδεση με την βάση υπάρχει ένα αντίστοιχο μήνυμα επιτυχίας/λάθους που εκτυπώνεται
στον χρήστη και ανακατεύθυνση στην ιδιά html σελίδα. Για αυτό και όταν πατάει ο μηχανικός να του δείξει τα οχήματα που έχει για εξέταση
του προβάλει τα στοιχεία στην ιδιά σελίδα, για να μπορεί να τα συμπληρώσει στο πεδίο του "Update Customer Data" (που καλό είναι να μετονομαστεί σε Update Vehicle Data").
7.Μπηκε έλεγχος για τα οχήματα π βρίσκονται σε αναμονή για επιβεβαίωση, και πετάει μήνυμα στον μηχανικό σε περίπτωση π δεν υπάρχουν αλλά. 
8.Αν είναι επιτυχής ο έλεγχος του αυτοκίνητου υπολογίζει το ποσό επιστροφής και το εμφανίζει στον χρήστη.

Βελτιώσεις/Προτάσεις:

1.Αν γίνεται όταν κάνει ο μηχανικός Update τα πεδία να συμπληρώνονται αυτόματα απο την βάση με τα ήδη αποθηκευμένα στοιχεία, και αν θέλει να τα αλλάζει.
2.Δεν έχουν μπει έλεγχοι εδώ για τα πεδία εισαγωγής (αν πχ ο αριθμός κυκλοφορίας είναι σωστός κλπ.) αν είναι βάζουμε τους ιδίους με το Carform για τον αριθμό κυκλοφορίας.
3.Να μπει ένα παραπάνω κουμπι που θα ενημερώνει την βάση πως το ποσό επιστροφής παραδόθηκε στον χρήστη(πεδίο Vehicle:Return Prize Date).
4.Οτι παραπάνω  ελέγχους μπορείτε να σκεφτείτε για τα πεδία εισαγωγής.
